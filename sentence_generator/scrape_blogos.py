from domextract import Extractor
from janome.tokenizer import Tokenizer
import mojimoji
import re

ext = Extractor()
baseurl = "https://blogos.com/article/"
# これはtext_all_articles_train.txt用
article_numbers = ["295654","295731","295731","295832","295832","295913","295913","296508","296508","296564","296564","297116","297116","297136","297136","297231","297231","297447","297447","298120","298120","298199","298199","298537","298537","298826","298826","298909","298909","299767","299767","299844","299844","299862","299862","300238","300238","301015","301015","301203","301203","301213","301213","301519","301519","301613","301613","302151","302151","302599","302599","302586","302586","302608","302608","302815","302815","302897","302897","303085","303085","303435","303435","304493","304493","304676","304676","305817","305817","305914","305914","306088","306088","306117","306117","306206","306206","306187","306187","306668","306668","306957","306957","307301","307301","307212","307212","307644","307644","307420","307420","307688","307688","308057","308057","308574","308574","308953","308953","309122","309122","309111","309111","309391","309391","309342","309342","309615","309615","310025","310025","310283","310283","310534","310534","310742","310742","311363","311363","311425","311425","311675","311675","312285","312285","312385","312385","312583","312583","312974","312974","312996","312996","312984","312984","313252","313252","313268","313268","313763","313763","314351","314351","314627","314627","315268","315268","315586","315586","315706","315706","315970","315970","316398","316398","316888","316888","316946","316946","317033","317033","317451","317451","317524","317524","317831","317831","317883","317883","318092","318092","318147","318147","318189","318189","318288","318288","318467","318467","318567","318567","318669","318669","319098","319098","319134","319134","319303","319303","320219","320219","320664","320664","320946","320946","320997","320997","321251","321251","321778","321778","322425","322425","322434","322434","322582","322582","323205","323205","322778","322778","322798","322798","322807","322807","323101","323101","323095","323095","323669","323669","323713","323713","323720","323720","323922","323922","324043","324043","324179","324179","324412","324412","324967","324967","325207","325207","325361","325361","325694","325694","325689","325689","325707","325707","326076","326076","326111","326111","326514","326514","326649","326649","327511","327511","327807","327807","327846","327846","327868","327868","328074","328074","328144","328144","328868","328868","329135","329135","329541","329541","329571","329571","329628","329628","329909","329909","330272","330272","330324","330324","330323","330323","330545","330545","330697","330697","330745","330745","330881","330881","331473","331473","331478","331478","331928","331928","332147","332147"]
# これはtext_all_articles_valid.txt用
article_numbers = ["332418","332418","332419","332419","332616","332616","333075","333075","333096","333096","333465","333465","333532","333532","333793","333793","333859","333859","333907","333907"]
article_numbers = list(set(article_numbers))
t = Tokenizer()

text_all_articles = ""
for article_number in article_numbers:
    url = baseurl + article_number + "/"
    text_article = ext.extract(url)
    if text_article[-1:] != "。":
        text_article += "。"
    
    text_article_masked = ""
    tokens = t.tokenize(text_article)
    for token in tokens:
        if(token.part_of_speech.split(',')[2] == "人名"):
            text_article_masked += "NME"
        elif(token.part_of_speech.split(',')[2] == "地域"):
            text_article_masked += "PLC"
        else:
            text_article_masked += token.surface
    text_article_masked = text_article_masked.replace(" ","")
    text_article_masked = mojimoji.zen_to_han(text_article_masked)
    text_article_masked = mojimoji.han_to_zen(text_article_masked, digit=False,ascii=False)
    text_article_masked = re.sub(r"\d+", "NUM", text_article_masked)
    text_article_masked = text_article_masked.replace("NMENMENME","NME")
    text_article_masked = text_article_masked.replace("NMENME","NME")
    text_article_masked = text_article_masked.replace("PLCPLCPLC","PLC")
    text_article_masked = text_article_masked.replace("PLCPLC","PLC")
    text_all_articles += text_article_masked
    print("len of text_all_articles",len(text_all_articles))

with open('text_all_articles_valid.txt', mode='w') as f:
    f.write(text_all_articles)